<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Siquijor Online Pedicab Feedback</title>
<style>
body { font-family: Arial; background:#f7f7f7; padding:20px; }
header { text-align:center; padding:20px; background:linear-gradient(90deg,#2e7d32,#81c784); border-radius:15px; color:white; box-shadow:0 3px 10px rgba(0,0,0,0.1); }
header h1 { font-size:3em; margin:0; font-weight:bold; }
header h2 { font-size:1.3em; font-style:italic; margin-top:5px; color:#e0f2f1; }

.card { background:#fff; padding:20px; border-radius:10px; box-shadow:0 3px 10px rgba(0,0,0,0.1); max-width:500px; margin:auto; }
label { display:block; margin-top:10px; font-weight:600; }
input, select, textarea { width:100%; padding:10px; margin-top:5px; border-radius:8px; border:1px solid #ccc; }
textarea { resize: vertical; }
button { padding:12px 20px; margin-top:15px; width:100%; background:#2e7d32; color:white; font-size:16px; border:none; border-radius:10px; cursor:pointer; }
.success-popup { display:none; background:#e8fbef; border-left:4px solid #2e7d32; padding:10px; margin-top:15px; text-align:center; font-weight:bold; }
.disclaimer { font-size:0.9em; color:#555; margin-top:10px; text-align:center; }
</style>
</head>
<body>

<header>
  <h1>Feedback Form</h1>
  <h2>Help us improve our service</h2>
</header>

<div class="card">
  <form id="feedbackForm">
    <label>Name*</label>
    <input type="text" id="name" required>

    <label>Email*</label>
    <input type="email" id="email" required>

    <label>Rating*</label>
    <select id="rating" required>
      <option value="">Select rating</option>
      <option value="Excellent">Excellent</option>
      <option value="Good">Good</option>
      <option value="Average">Average</option>
      <option value="Poor">Poor</option>
    </select>

    <label>Feedback*</label>
    <textarea id="feedback" rows="4" placeholder="Your comments..." required></textarea>

    <input type="hidden" id="dateTime">

    <button type="button" id="submitBtn">Submit Feedback</button>

    <div class="disclaimer">
      üîí Your information will only be used for service improvement.
    </div>
  </form>

  <div class="success-popup" id="successPopup">
    ‚úî Your feedback has been submitted successfully!
  </div>
</div>

<script>
const WEB_URL = "https://script.google.com/macros/s/AKfycbwfRW9cjGgKlIUEqhf7dHeXkaoVp_ZWqclMxPP0ERQOS4epnqEDDCWDcEmTFVlJlqpw1w/exec"; // Web App URL
const API_SECRET = "siquijor@2025";

// Autofill date/time
document.getElementById("dateTime").value = new Date().toISOString();

function validateForm() {
  return document.getElementById("feedbackForm").checkValidity();
}

async function sendFeedback() {
  if (!validateForm()) {
    alert("Please fill all required fields.");
    return;
  }

  const payload = {
    requestType: "feedback",
    name: document.getElementById("name").value,
    email: document.getElementById("email").value,
    rating: document.getElementById("rating").value,
    feedback: document.getElementById("feedback").value,
    dateTime: document.getElementById("dateTime").value,
    secretKey: API_SECRET
  };

  try {
    // No-cors approach like Pedicab app
    await fetch(WEB_URL, {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    document.getElementById("successPopup").style.display = "block";
    document.getElementById("feedbackForm").reset();
    document.getElementById("dateTime").value = new Date().toISOString();

  } catch (err) {
    alert("‚ùå ERROR sending feedback: " + err);
  }
}

document.getElementById("submitBtn").onclick = sendFeedback;
</script>

</body>
</html>
